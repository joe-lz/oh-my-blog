{"ast":null,"code":"var __jsx = React.createElement;\nimport Head from 'next/head';\nimport AV from 'leancloud-storage';\nimport dynamic from 'next/dynamic';\nimport { Table, Tag, Space, Switch, notification, Radio, Popover, Modal, Button } from 'antd';\nimport { QuestionCircleOutlined } from '@ant-design/icons';\nimport React, { useState, useEffect } from 'react';\nimport styles from './index.module.scss';\nimport Layout from 'src/components/admin/Layout';\nimport InputItem from 'src/components/admin/InputItem';\nimport { createProfile, getProfileList, updateProfile } from 'src/service/profile';\n\nfunction AdminHome(props) {\n  const {\n    0: curUserInfo,\n    1: setcurUserInfo\n  } = useState(null);\n  const {\n    0: profile,\n    1: setprofile\n  } = useState(null);\n  const {\n    0: logo,\n    1: setlogo\n  } = useState('');\n  const {\n    0: title,\n    1: settitle\n  } = useState('');\n  const {\n    0: github,\n    1: setgithub\n  } = useState('');\n  const {\n    0: social_link,\n    1: setsocial_link\n  } = useState('');\n  const {\n    0: copyright,\n    1: setcopyright\n  } = useState('');\n  const {\n    0: allowAComment,\n    1: setallowAComment\n  } = useState(false);\n  const {\n    0: allowBComment,\n    1: setallowBComment\n  } = useState(false);\n  const {\n    0: showBlog,\n    1: setshowBlog\n  } = useState(false);\n  const {\n    0: blogName,\n    1: setblogName\n  } = useState(''); // 获取资料\n\n  const getProfile = () => {\n    getProfileList().then(res => {\n      if (res) {\n        setprofile(res);\n        setlogo(res.attributes.logo);\n        settitle(res.attributes.title);\n        setgithub(res.attributes.github);\n        setsocial_link(res.attributes.social_link);\n        setcopyright(res.attributes.copyright);\n        setallowAComment(res.attributes.allowAComment);\n        setallowBComment(res.attributes.allowBComment);\n        setshowBlog(res.attributes.showBlog);\n        setblogName(res.attributes.blogName);\n      } else {\n        createProfile().then(resCreate => {\n          setprofile(resCreate);\n        });\n      }\n    });\n  }; // 更新profile\n\n\n  const handlesubmit = async () => {\n    await updateProfile({\n      profileItem: profile,\n      params: {\n        logo,\n        title,\n        github,\n        social_link,\n        copyright,\n        allowAComment,\n        allowBComment,\n        showBlog,\n        blogName\n      }\n    });\n    getProfile();\n    notification.success({\n      message: '更新成功' // description: \"请输入用户名、密码\",\n\n    });\n  };\n\n  useEffect(() => {\n    getProfile();\n  }, []);\n  return __jsx(Layout, {\n    onChange: params => {\n      setcurUserInfo(params.userinfo);\n    }\n  }, __jsx(\"p\", {\n    className: \"_admin_body_section_title\"\n  }, \"\\u57FA\\u672C\\u8BBE\\u7F6E\"), curUserInfo && curUserInfo.toJSON().priority === 100 && profile ? __jsx(\"div\", {\n    className: styles.setting\n  }, __jsx(\"div\", {\n    className: \"_admin_body_section_block\",\n    style: {\n      padding: 30\n    }\n  }, __jsx(InputItem, {\n    title: \"Logo\",\n    type: \"image\",\n    value: logo,\n    onChange: e => {\n      setlogo(e);\n    }\n  }), __jsx(InputItem, {\n    title: \"\\u6807\\u9898\",\n    placeholder: \"\\u8BF7\\u8F93\\u5165\\u6807\\u9898\",\n    value: title,\n    onChange: e => {\n      settitle(e);\n    }\n  }), __jsx(InputItem, {\n    title: \"Github\",\n    placeholder: \"\\u8BF7\\u8F93\\u5165url\",\n    value: github,\n    onChange: e => {\n      setgithub(e);\n    }\n  }), __jsx(InputItem, {\n    title: \"\\u793E\\u4EA4\\u94FE\\u63A5\",\n    placeholder: \"\\u8BF7\\u8F93\\u5165url\",\n    value: social_link,\n    onChange: e => {\n      setsocial_link(e);\n    }\n  }), __jsx(InputItem, {\n    title: \"CopyRight\",\n    placeholder: \"\\u8BF7\\u8F93\\u5165copyright\",\n    value: copyright,\n    onChange: e => {\n      setcopyright(e);\n    }\n  })), __jsx(\"div\", {\n    className: \"_admin_body_section_block\",\n    style: {\n      padding: 30\n    }\n  }, __jsx(InputItem, {\n    type: \"switch\",\n    title: \"\\u5141\\u8BB8\\u8BC4\\u8BBA\\u6587\\u7AE0\",\n    value: allowAComment,\n    onChange: e => {\n      setallowAComment(e);\n    }\n  })), __jsx(\"div\", {\n    className: \"_admin_body_section_block\",\n    style: {\n      padding: 30\n    }\n  }, __jsx(InputItem, {\n    type: \"switch\",\n    title: `开放动态模块`,\n    value: showBlog,\n    onChange: e => {\n      setshowBlog(e);\n    }\n  }), __jsx(InputItem, {\n    type: \"switch\",\n    title: `允许评论动态模块`,\n    value: allowBComment,\n    onChange: e => {\n      setallowBComment(e);\n    }\n  }), __jsx(InputItem, {\n    title: `动态模块名称`,\n    placeholder: \"\\u8BF7\\u8F93\\u5165\",\n    value: blogName,\n    onChange: e => {\n      setblogName(e);\n    }\n  })), __jsx(Button, {\n    type: \"primary\",\n    size: \"large\",\n    onClick: () => {\n      handlesubmit();\n    }\n  }, \"\\u4FDD\\u5B58\")) : __jsx(\"div\", {\n    className: \"_admin_body_section_block\",\n    style: {\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      minHeight: 100\n    }\n  }, \"\\u6682\\u65E0\\u6743\\u9650\\uFF0C\\u8BF7\\u8054\\u7CFB\\u7BA1\\u7406\\u5458\\u5F00\\u901A\\uFF5E\"));\n}\n\nexport default AdminHome;","map":null,"metadata":{},"sourceType":"module"}