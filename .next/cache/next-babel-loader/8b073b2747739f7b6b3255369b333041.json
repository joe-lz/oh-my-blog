{"ast":null,"code":"var __jsx = React.createElement;\nimport Head from \"next/head\";\nimport Link from \"next/link\";\nimport AV from \"leancloud-storage\";\nimport dayjs from \"dayjs\";\nimport { FileImageOutlined, LoadingOutlined, PlusOutlined } from \"@ant-design/icons\";\nimport React, { useState, useEffect } from \"react\";\nimport { Tree, Button, notification, Input, Modal, message } from \"antd\";\nimport styles from \"./index.module.scss\";\nimport Upload from \"src/components/admin/Upload\";\nimport { getArticleById, updateArticle } from \"src/service/article\";\nimport articleStatus from \"src/lib/articleStatus\";\nComponents.defaultProps = {\n  item: null,\n  onChange: () => {}\n};\n\nfunction Components(props) {\n  const {\n    0: modalShow,\n    1: setmodalShow\n  } = useState(false);\n  const {\n    0: posterUrl,\n    1: setposterUrl\n  } = useState(\"\");\n  let curStatus = null;\n  const articleItem = props.item ? props.item.toJSON() : null;\n  articleStatus.map(obj => {\n    if (obj.value === articleItem.status) {\n      curStatus = obj;\n    }\n\n    return obj;\n  });\n  useEffect(() => {}, []);\n  return __jsx(React.Fragment, null, articleItem && __jsx(\"div\", {\n    className: styles.articles_item\n  }, __jsx(\"div\", {\n    className: styles.articles_item_poster,\n    style: {\n      backgroundImage: `url(${articleItem.poster})`\n    }\n  }, !articleItem.poster && __jsx(FileImageOutlined, {\n    className: styles.articles_item_poster_placeholder\n  }), __jsx(\"div\", {\n    className: styles.articles_item_operation\n  }, __jsx(\"div\", {\n    className: styles.articles_item_operation_btn,\n    onClick: () => {\n      setmodalShow(true);\n    }\n  }, \"\\u4E0A\\u4F20\\u5C01\\u9762\"), __jsx(\"a\", {\n    className: styles.articles_item_operation_btn,\n    target: \"_blank\",\n    href: `/admin/feature/articles/${props.item.id}`\n  }, \"\\u7F16\\u8F91\")), __jsx(\"div\", {\n    className: styles.articles_item_operation2\n  }, curStatus && curStatus.btns.map(obj => {\n    return __jsx(\"div\", {\n      className: obj.status === 5 ? styles.articles_item_operation_btn_danger : styles.articles_item_operation_btn,\n      key: obj.label,\n      onClick: async () => {\n        let comfirmText = \"\";\n\n        if (obj.status === 5) {\n          comfirmText = `确认删除文章【${articleItem.title}】吗？\\n删除后可在【回收站】栏目恢复。`;\n        }\n\n        if (obj.status === 4) {\n          comfirmText = `确认下线文章【${articleItem.title}】吗？`;\n        }\n\n        if (obj.status === 3) {\n          comfirmText = `确认上线文章【${articleItem.title}】吗？`;\n        }\n\n        if (confirm(comfirmText)) {\n          await updateArticle({\n            articleItem: props.item,\n            params: {\n              status: obj.status\n            }\n          });\n          await props.onChange();\n        }\n      }\n    }, obj.label);\n  }))), __jsx(\"a\", {\n    className: styles.articles_item_content,\n    target: \"_blank\",\n    href: `/admin/feature/articles/${props.item.id}`\n  }, __jsx(\"p\", {\n    className: styles.articles_item_title\n  }, articleItem.title), __jsx(\"div\", {\n    className: styles.articles_item_bottom\n  }, __jsx(\"p\", {\n    className: styles.articles_item_author\n  }, articleItem.author ? articleItem.author.nickname : \"\"), __jsx(\"p\", {\n    className: styles.articles_item_updateAt\n  }, dayjs(articleItem.updatedAt).format(\"YYYY/MM/DD\"), \"\\u66F4\\u65B0\"))), __jsx(Modal // title=\"上传封面\"\n  // closable={false}\n  , {\n    width: 900,\n    visible: modalShow,\n    onCancel: () => {\n      setmodalShow(false);\n    },\n    onOk: () => {\n      handleCreate();\n    },\n    okText: \"\\u4FDD\\u5B58\",\n    cancelText: \"\\u53D6\\u6D88\",\n    bodyStyle: {\n      padding: 0\n    },\n    footer: null\n  }, modalShow && __jsx(Upload, {\n    onChoose: async ({\n      url\n    }) => {\n      await updateArticle({\n        articleItem: props.item,\n        params: {\n          poster: url\n        }\n      });\n      await props.onChange();\n      setmodalShow(false);\n    }\n  }))));\n}\n\nexport default Components;","map":null,"metadata":{},"sourceType":"module"}