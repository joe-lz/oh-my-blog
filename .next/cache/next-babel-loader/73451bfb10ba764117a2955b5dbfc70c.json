{"ast":null,"code":"import AV from 'leancloud-storage';\nexport const createComment = params => {\n  return new Promise((resolve, reject) => {\n    const comments = new AV.Object('CMS_Comments');\n    comments.set('status', 1);\n    comments.set('likes', 0);\n    comments.set('likesUser', []);\n    comments.set('children', []);\n    Object.keys(params).map(keyname => {\n      comments.set(keyname, params[keyname]);\n    }); // 将对象保存到云端\n\n    comments.save().then(res => {\n      resolve(res);\n    }, error => {\n      // 异常处理\n      reject(error);\n    });\n  });\n};\nexport const updateComment = ({\n  commentItem,\n  params\n}) => {\n  return new Promise((resolve, reject) => {\n    if (params.likes) {\n      commentItem.increment('likes', params.likes);\n\n      if (params.likes > 0) {\n        commentItem.addUnique('likesUser', params.likesUser_id);\n      } else {\n        commentItem.remove('likesUser', params.likesUser_id);\n      }\n    } else {\n      Object.keys(params).map(keyname => {\n        commentItem.set(keyname, params[keyname]);\n      });\n    }\n\n    commentItem.save().then(res => {\n      resolve(res);\n    }, error => {\n      // 异常处理\n      reject(error);\n    });\n  });\n};\nexport const getCommentList = (params = {}) => {\n  return new Promise((resolve, reject) => {\n    const query = new AV.Query('CMS_Comments');\n    query.descending('createdAt');\n    query.include('user');\n    query.limit(50);\n    Object.keys(params).map(keyname => {\n      query.equalTo(keyname, params[keyname]);\n    });\n    query.find().then(res => {\n      resolve(res);\n    }).catch(err => {\n      reject(err);\n    });\n  });\n};\nexport const countComments = (params = {}) => {\n  return new Promise((resolve, reject) => {\n    const query = new AV.Query('CMS_Comments');\n    query.equalTo('aid', params.article);\n    query.count().then(number => {\n      resolve(number);\n    });\n  });\n};","map":null,"metadata":{},"sourceType":"module"}