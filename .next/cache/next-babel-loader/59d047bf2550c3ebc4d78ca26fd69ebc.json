{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nvar __jsx = React.createElement;\nimport Head from \"next/head\";\nimport Link from \"next/link\";\nimport AV from \"leancloud-storage\";\nimport dayjs from \"dayjs\";\nimport { FileImageOutlined, LoadingOutlined, PlusOutlined } from \"@ant-design/icons\";\nimport React, { useState, useEffect } from \"react\";\nimport { Tree, Button, notification, Input, Modal, message } from \"antd\";\nimport styles from \"./index.module.scss\";\nimport Upload from \"src/components/admin/Upload\";\nimport { getArticleById, updateArticle } from \"src/service/article\";\nimport articleStatus from \"src/lib/articleStatus\";\nComponents.defaultProps = {\n  item: null,\n  onChange: function onChange() {}\n};\n\nfunction Components(props) {\n  var _useState = useState(false),\n      modalShow = _useState[0],\n      setmodalShow = _useState[1];\n\n  var _useState2 = useState(\"\"),\n      posterUrl = _useState2[0],\n      setposterUrl = _useState2[1];\n\n  var curStatus = null;\n  var articleItem = props.item ? props.item.toJSON() : null;\n  articleStatus.map(function (obj) {\n    if (obj.value === articleItem.status) {\n      curStatus = obj;\n    }\n\n    return obj;\n  });\n  useEffect(function () {}, []);\n  return __jsx(React.Fragment, null, articleItem && __jsx(\"div\", {\n    className: styles.articles_item\n  }, __jsx(\"div\", {\n    className: styles.articles_item_poster,\n    style: {\n      backgroundImage: \"url(\".concat(articleItem.poster, \")\")\n    }\n  }, !articleItem.poster && __jsx(FileImageOutlined, {\n    className: styles.articles_item_poster_placeholder\n  }), __jsx(\"div\", {\n    className: styles.articles_item_operation\n  }, __jsx(\"div\", {\n    className: styles.articles_item_operation_btn,\n    onClick: function onClick() {\n      setmodalShow(true);\n    }\n  }, \"\\u4E0A\\u4F20\\u5C01\\u9762\"), __jsx(\"a\", {\n    className: styles.articles_item_operation_btn,\n    target: \"_blank\",\n    href: \"/admin/feature/articles/\".concat(props.item.id)\n  }, \"\\u7F16\\u8F91\")), __jsx(\"div\", {\n    className: styles.articles_item_operation2\n  }, curStatus && curStatus.btns.map(function (obj) {\n    return __jsx(\"div\", {\n      className: obj.status === 5 ? styles.articles_item_operation_btn_danger : styles.articles_item_operation_btn,\n      key: obj.label,\n      onClick: function _callee() {\n        var comfirmText;\n        return _regeneratorRuntime.async(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                comfirmText = \"\";\n\n                if (obj.status === 5) {\n                  comfirmText = \"\\u786E\\u8BA4\\u5220\\u9664\\u6587\\u7AE0\\u3010\".concat(articleItem.title, \"\\u3011\\u5417\\uFF1F\\n\\u5220\\u9664\\u540E\\u53EF\\u5728\\u3010\\u56DE\\u6536\\u7AD9\\u3011\\u680F\\u76EE\\u6062\\u590D\\u3002\");\n                }\n\n                if (obj.status === 4) {\n                  comfirmText = \"\\u786E\\u8BA4\\u4E0B\\u7EBF\\u6587\\u7AE0\\u3010\".concat(articleItem.title, \"\\u3011\\u5417\\uFF1F\");\n                }\n\n                if (obj.status === 3) {\n                  comfirmText = \"\\u786E\\u8BA4\\u4E0A\\u7EBF\\u6587\\u7AE0\\u3010\".concat(articleItem.title, \"\\u3011\\u5417\\uFF1F\");\n                }\n\n                if (!confirm(comfirmText)) {\n                  _context.next = 9;\n                  break;\n                }\n\n                _context.next = 7;\n                return _regeneratorRuntime.awrap(updateArticle({\n                  articleItem: props.item,\n                  params: {\n                    status: obj.status\n                  }\n                }));\n\n              case 7:\n                _context.next = 9;\n                return _regeneratorRuntime.awrap(props.onChange());\n\n              case 9:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, null, null, null, Promise);\n      }\n    }, obj.label);\n  }))), __jsx(\"a\", {\n    className: styles.articles_item_content,\n    target: \"_blank\",\n    href: \"/admin/feature/articles/\".concat(props.item.id)\n  }, __jsx(\"p\", {\n    className: styles.articles_item_title\n  }, articleItem.title), __jsx(\"div\", {\n    className: styles.articles_item_bottom\n  }, __jsx(\"p\", {\n    className: styles.articles_item_author\n  }, articleItem.author ? articleItem.author.nickname : \"\"), __jsx(\"p\", {\n    className: styles.articles_item_updateAt\n  }, dayjs(articleItem.updatedAt).format(\"YYYY/MM/DD\"), \"\\u66F4\\u65B0\"))), __jsx(Modal // title=\"上传封面\"\n  // closable={false}\n  , {\n    width: 900,\n    visible: modalShow,\n    onCancel: function onCancel() {\n      setmodalShow(false);\n    },\n    onOk: function onOk() {\n      handleCreate();\n    },\n    okText: \"\\u4FDD\\u5B58\",\n    cancelText: \"\\u53D6\\u6D88\",\n    bodyStyle: {\n      padding: 0\n    },\n    footer: null\n  }, modalShow && __jsx(Upload, {\n    onChoose: function _callee2(_ref) {\n      var url;\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              url = _ref.url;\n              _context2.next = 3;\n              return _regeneratorRuntime.awrap(updateArticle({\n                articleItem: props.item,\n                params: {\n                  poster: url\n                }\n              }));\n\n            case 3:\n              _context2.next = 5;\n              return _regeneratorRuntime.awrap(props.onChange());\n\n            case 5:\n              setmodalShow(false);\n\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    }\n  }))));\n}\n\nexport default Components;","map":null,"metadata":{},"sourceType":"module"}